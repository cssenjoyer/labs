/*Заполнить массив натуральными числами с клавиатуры. Удалить из
массива все двузначные числа.*/

#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define MAX_SIZE 1000

void inputvalue(int* value) {
    while (1) {
        printf("enter a natural number: ");
        if (scanf_s("%d", value) == 1 && *value > 0) {  // проверяем, что число положительное
            break;
        }
        else {
            printf("error, only positive natural numbers allowed!\n");
            while (getchar() != '\n');  // очистка буфера ввода
        }
    }
}

void inputvalueelement(int* value) {
    while (1) {
        if (scanf_s("%d", value) == 1 && *value > 0) {  // проверяем, что введенное число положительное
            break;
        }
        else {
            printf("error, only positive natural numbers allowed!\n");
            while (getchar() != '\n');  // очистка буфера ввода
        }
    }
}

int main() {
    int n;
    int* arr;
    int* newarr;
    int new_size = 0;
    char initchoice;

    printf("enter the size of the array (less than %d): ", MAX_SIZE);
    scanf_s("%d", &n);

    if (n <= 0 || n > MAX_SIZE) {
        printf("error, invalid size! ");
        return 1;
    }

    arr = (int*)malloc(n * sizeof(int));  // выделяем память для массива arr
    if (arr == NULL) { // проверка на успешное выделение памяти
        printf("memory allocation failed! ");
        return 1;
    }

    // очищаем буфер перед вводом символа
    while (getchar() != '\n');

    printf("to fill the array with random numbers (1 to 99), press r/R. Press any other key to enter manually: ");
    scanf_s("%c", &initchoice, 1);  // пробел перед %c для корректного чтения

    if (initchoice == 'r' || initchoice == 'R') {
        srand(time(NULL));  // инициализация генератора случайных чисел
        for (int i = 0; i < n; i++) {
            arr[i] = rand() % 99 + 1;  // генерация случайных чисел от 1 до 99
        }
        printf("array initialized with random numbers!\n");
    }
    else {
        printf("enter %d natural numbers:\n", n);
        for (int i = 0; i < n; i++) {
            printf("element %d: ", i + 1);
            inputvalueelement(&arr[i]);  // ввод элементов массива
        }
    }

    // вывод исходного массива
    printf("Your array: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");

    // создание нового массива без двузначных чисел
    newarr = (int*)malloc(n * sizeof(int));  // выделяем память для нового массива
    if (newarr == NULL) {
        printf("memory allocation failed! ");
        free(arr);
        return 1;
    }

    // копирование чисел, которые не являются двузначными
    for (int i = 0; i < n; i++) {
        // удаляем двузначные числа (10-99)
        if (arr[i] < 10 || arr[i] > 99) {
            newarr[new_size] = arr[i];
            new_size++;
        }
    }

    // вывод массива после удаления двузначных чисел
    printf("array after removing two-digit numbers: \n");
    for (int i = 0; i < new_size; i++) {
        printf("%d ", newarr[i]);
    }
    printf("\n");

    // освобождаем память
    free(arr);
    free(newarr);

    return 0;
}
